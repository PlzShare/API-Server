<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace='user'>

	<insert id="insert" parameterType="user">
		<![CDATA[
			insert into user(id, password, name, nickname) 
				values(#{id}, #{password},#{name}, #{nickname})
		]]>
	</insert>
	
	<select id="find" parameterType="user" resultType="user">
		<![CDATA[
		select no, id, name, nickname, profile 
		from user 
		where id=#{id } and password=#{password }
		]]>
	</select>
	
	<select id="findNo" parameterType="long" resultType="user">
		<![CDATA[
		select no, id, name, nickname, profile 
		from user 
		where no=#{no }
		]]>
	</select>

	<update id="update" parameterType="user">
		update user 
		set 
			name = name
			<if test="nickname != null and nickname != ''">
				,nickname=#{nickname }
			</if>
			<if test="profile != null and profile != ''">
				,profile =#{profile}
			</if>
			<if test="password != null and password != ''">
				,password=#{password }
			</if>		
		where no=#{no }
	</update>
	
	<update id="updateprofile" parameterType="user">
		update user set profile = '/upload-images/user/profile/profile.jpg'
				where no = #{no }
	</update>
	
	<update id="delete" parameterType="long">
		<![CDATA[
		update user 
		set leave_date=now() 
		where no=#{no }
		]]>
	</update>
	
	<select id="findList" parameterType="searchInfo" resultType="user">
		<![CDATA[
			select no, id 
			from user 
			where id=#{userId}
		]]>
		
	</select>
	
	<select id="checkUser" parameterType="String" resultType="long">
		<![CDATA[
			select no
			from user 
			where id=#{userId}
		]]>
	</select>
	
</mapper>