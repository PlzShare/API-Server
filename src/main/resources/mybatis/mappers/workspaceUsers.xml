<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="workspaceUsers">
	<insert id="invite" parameterType="map">
		<if test='userRole == 0'>
			<![CDATA[
			insert into workspace_user(user_no, workspace_no, role) values(#{userNo}, #{workspaceNo}, now(), 'admin');
			]]>
		</if>
		<if test='userRole != 0'>
			<![CDATA[
			insert into workspace_user(user_no, workspace_no, reg_date) values(#{userNo}, #{workspaceNo}, now());
			]]>
		</if>
	</insert>
	
	<!-- 미완성 -->
	<update id="leave" parameterType="map">
		<if test='user == 0'>
			<![CDATA[

			]]>
		</if>
		<if test='user != 0'>
			<![CDATA[
			update workspace_user set reg_date = now()
			where user_no = #{userNo}
			and workspace_no = #{workspaceNo};
			]]>
		</if>
	</update>
	
	<update id="changeRoleUA" parameterType="map">
		<![CDATA[
		update workspace_user set role = 'user'
		where role = 'admin'
		  and user_no = #{adminNo}
		  and workspace_no = #{workspaceNo}
		]]>
	</update>
	
	<update id="changeRoleAU" parameterType="map">
		<![CDATA[
		update workspace_user set role = 'admin'
		where role = 'user'
		  and user_no = #{userNo}
		  and workspace_no = #{workspaceNo}
		]]>
	</update>
</mapper>